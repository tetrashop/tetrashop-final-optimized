<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetrashop - تست فوری</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            min-height: 100vh; 
            padding: 2rem;
            line-height: 1.6;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 2rem; }
        .card { 
            background: rgba(255,255,255,0.1); 
            padding: 2rem; 
            border-radius: 15px; 
            margin: 1rem 0; 
            backdrop-filter
# ترمینال جدید باز کنید (Swipe left -> New session)
cd tetrashop-final-optimized/frontend

# ایجاد فایل HTML برای تست
mkdir -p public
cat > public/index.html << 'EOF'
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetrashop - تست فوری</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            min-height: 100vh; 
            padding: 2rem;
            line-height: 1.6;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 2rem; }
        .card { 
            background: rgba(255,255,255,0.1); 
            padding: 2rem; 
            border-radius: 15px; 
            margin: 1rem 0; 
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .btn { 
            background: white; 
            color: #667eea; 
            padding: 1rem 2rem; 
            border: none; 
            border-radius: 8px; 
            margin: 0.5rem; 
            cursor: pointer; 
            font-weight: bold;
            text-decoration: none;
            display: inline-block;
            transition: transform 0.2s;
        }
        .btn:hover { transform: translateY(-2px); }
        .success { background: rgba(76, 175, 80, 0.2); padding: 1rem; border-radius: 8px; border-right: 4px solid #4CAF50; }
        .error { background: rgba(244, 67, 54, 0.2); padding: 1rem; border-radius: 8px; border-right: 4px solid #f44336; }
        .product { background: rgba(255,255,255,0.05); padding: 1rem; margin: 0.5rem 0; border-radius: 8px; }
        .loading { text-align: center; padding: 2rem; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🛒 Tetrashop</h1>
            <p>تست فوری - نسخه ۲.۰.۰</p>
        </div>
        
        <div class="card">
            <h2>🧪 تست سیستم</h2>
            <div>
                <button class="btn" onclick="testBackend()">تست Backend</button>
                <button class="btn" onclick="loadProducts()">دریافت محصولات</button>
                <button class="btn" onclick="testAll()">تست کامل</button>
                <a href="http://localhost:5000/api/health" class="btn" target="_blank">بررسی سلامت</a>
            </div>
        </div>
        
        <div id="result"></div>
        
        <div class="card">
            <h3>📊 وضعیت سرویس‌ها</h3>
            <div id="status">
                <div class="loading">⏳ در حال بررسی...</div>
            </div>
        </div>
    </div>

    <script>
        async function testBackend() {
            const result = document.getElementById('result');
            result.innerHTML = '<div class="card"><div class="loading">🔍 در حال اتصال به Backend...</div></div>';
            
            try {
                const response = await fetch('http://localhost:5000/api/health');
                const data = await response.json();
                
                result.innerHTML = `
                    <div class="card success">
                        <h3>✅ Backend فعال است</h3>
                        <p><strong>وضعیت:</strong> ${data.status}</p>
                        <p><strong>پیام:</strong> ${data.message}</p>
                        <p><strong>ورژن:</strong> ${data.version}</p>
                        <p><strong>زمان:</strong> ${new Date(data.timestamp).toLocaleString('fa-IR')}</p>
                    </div>
                `;
                
                updateStatus('backend', true);
            } catch (error) {
                result.innerHTML = `
                    <div class="card error">
                        <h3>❌ خطا در اتصال به Backend</h3>
                        <p><strong>مشکل:</strong> سرور Backend در دسترس نیست</p>
                        <p><strong>راه‌حل:</strong> مطمئن شوید سرور روی پورت 5000 اجرا شده است</p>
                        <p><strong>خطا:</strong> ${error.message}</p>
                    </div>
                `;
                updateStatus('backend', false);
            }
        }

        async function loadProducts() {
            const result = document.getElementById('result');
            result.innerHTML = '<div class="card"><div class="loading">🛒 در حال دریافت محصولات...</div></div>';
            
            try {
                const response = await fetch('http://localhost:5000/api/products');
                const products = await response.json();
                
                let productsHTML = products.map(product => `
                    <div class="product">
                        <h4>${product.name}</h4>
                        <p>${product.description}</p>
                        <p><strong>قیمت:</strong> ${product.price.toLocaleString('fa-IR')} تومان</p>
                        <p><strong>دسته‌بندی:</strong> ${product.category}</p>
                        <p><strong>موجودی:</strong> ${product.stock} عدد</p>
                    </div>
                `).join('');
                
                result.innerHTML = `
                    <div class="card success">
                        <h3>✅ محصولات دریافت شد (${products.length} محصول)</h3>
                        ${productsHTML}
                    </div>
                `;
                
                updateStatus('products', true);
            } catch (error) {
                result.innerHTML = `
                    <div class="card error">
                        <h3>❌ خطا در دریافت محصولات</h3>
                        <p>${error.message}</p>
                    </div>
                `;
                updateStatus('products', false);
            }
        }

        async function testAll() {
            await testBackend();
            if (document.querySelector('.success')) {
                setTimeout(loadProducts, 1000);
            }
        }

        function updateStatus(service, isWorking) {
            const statusDiv = document.getElementById('status');
            if (isWorking) {
                statusDiv.innerHTML = `<p>✅ ${service} فعال است</p>`;
            } else {
                statusDiv.innerHTML = `<p>❌ ${service} مشکل دارد</p>`;
            }
        }

        // تست خودکار
        setTimeout(testBackend, 1000);
    </script>
</body>
</html>
