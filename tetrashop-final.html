<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØªØ±Ø§Ø´Ø§Ù¾ - Ø³ÛŒØ³ØªÙ… ÙØ±ÙˆØ´ ÙØ¹Ø§Ù„</title>
    <style>
        body {
            font-family: Tahoma;
            margin: 20px;
            background: #f8f9fa;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .product-card {
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            background: white;
        }
        .btn-success {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .btn-success:hover {
            background: #218838;
        }
        .status-box {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            background: #e7f3ff;
            border-right: 4px solid #007bff;
        }
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ ØªØªØ±Ø§Ø´Ø§Ù¾ - Ø³ÛŒØ³ØªÙ… ÙØ±ÙˆØ´ ÙØ¹Ø§Ù„</h1>
        
        <div class="status-box">
            <strong>ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…:</strong>
            <span id="connectionStatus">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...</span>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div>ğŸ’° Ø¯Ø±Ø¢Ù…Ø¯ Ú©Ù„</div>
                <div id="totalRevenue" style="font-size: 24px; color: #28a745;">0 ØªÙˆÙ…Ø§Ù†</div>
            </div>
            <div class="stat-item">
                <div>ğŸ“¦ ØªØ¹Ø¯Ø§Ø¯ ÙØ±ÙˆØ´</div>
                <div id="totalSales" style="font-size: 24px; color: #007bff;">0 Ù…ÙˆØ±Ø¯</div>
            </div>
        </div>

        <!-- Ù…Ø­ØµÙˆÙ„ Û± -->
        <div class="product-card">
            <h3>ğŸ’ Ø¹Ø¶ÙˆÛŒØª Ø·Ù„Ø§ÛŒÛŒ</h3>
            <p>Ø¯Ø³ØªØ±Ø³ÛŒ Ú©Ø§Ù…Ù„ Ø¨Ù‡ ØªÙ…Ø§Ù… Ø§Ù…Ú©Ø§Ù†Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡</p>
            <div style="font-size: 20px; color: #28a745; margin: 15px 0;">29,000 ØªÙˆÙ…Ø§Ù†</div>
            <button class="btn-success" onclick="makeSale(1)">Ø®Ø±ÛŒØ¯ ÙÙˆØ±ÛŒ</button>
        </div>

        <!-- Ù…Ø­ØµÙˆÙ„ Û² -->
        <div class="product-card">
            <h3>ğŸ›ï¸ Ù‚Ø§Ù„Ø¨ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</h3>
            <p>Ù‚Ø§Ù„Ø¨ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø§ Ø·Ø±Ø§Ø­ÛŒ Ù…Ø¯Ø±Ù† Ùˆ ÙˆØ§Ú©Ù†Ø´â€ŒÚ¯Ø±Ø§</p>
            <div style="font-size: 20px; color: #007bff; margin: 15px 0;">49,000 ØªÙˆÙ…Ø§Ù†</div>
            <button class="btn-success" onclick="makeSale(2)">Ø®Ø±ÛŒØ¯ ÙÙˆØ±ÛŒ</button>
        </div>

        <!-- Ù…Ø­ØµÙˆÙ„ Û³ -->
        <div class="product-card">
            <h3>ğŸ“š Ø¯ÙˆØ±Ù‡ Ø¢Ù…ÙˆØ²Ø´ÛŒ</h3>
            <p>Ø¢Ù…ÙˆØ²Ø´ Ú©Ø§Ù…Ù„ ØªÙˆØ³Ø¹Ù‡ ÙˆØ¨ Ùˆ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ†ÙˆÛŒØ³ÛŒ</p>
            <div style="font-size: 20px; color: #6f42c1; margin: 15px 0;">79,000 ØªÙˆÙ…Ø§Ù†</div>
            <button class="btn-success" onclick="makeSale(3)">Ø®Ø±ÛŒØ¯ ÙÙˆØ±ÛŒ</button>
        </div>

        <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 8px;">
            <h3>ğŸ’¡ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ</h3>
            <p>Ø§Ú¯Ø± Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯ØŒ Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯:</p>
            <ul>
                <li>Ø³Ø±ÙˆØ± Ø¯Ø±Ø¢Ù…Ø¯Ø²Ø§ÛŒÛŒ Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡: <code>node revenue.js</code></li>
                <li>Ù¾ÙˆØ±Øª 3000 Ø¢Ø²Ø§Ø¯ Ø§Ø³Øª</li>
                <li>Ù…Ø±ÙˆØ±Ú¯Ø± Ø¨Ù‡ Ø§ÛŒÙ†ØªØ±Ù†Øª Ù…ØªØµÙ„ Ø§Ø³Øª</li>
            </ul>
        </div>
    </div>

    <script>
        // Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„Ø§Øª
        const products = {
            1: { name: 'Ø¹Ø¶ÙˆÛŒØª Ø·Ù„Ø§ÛŒÛŒ', price: 29000 },
            2: { name: 'Ù‚Ø§Ù„Ø¨ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ', price: 49000 },
            3: { name: 'Ø¯ÙˆØ±Ù‡ Ø¢Ù…ÙˆØ²Ø´ÛŒ', price: 79000 }
        };

        // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„
        async function checkConnection() {
            try {
                const response = await fetch('http://localhost:3000/api/stats');
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('connectionStatus').innerHTML = 
                        'âœ… Ø³ÛŒØ³ØªÙ… Ø¯Ø±Ø¢Ù…Ø¯Ø²Ø§ÛŒÛŒ Ù…ØªØµÙ„ Ø§Ø³Øª';
                    document.getElementById('totalRevenue').textContent = 
                        data.totalRevenue.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
                    document.getElementById('totalSales').textContent = 
                        data.totalSales + ' Ù…ÙˆØ±Ø¯';
                    return true;
                }
            } catch (error) {
                document.getElementById('connectionStatus').innerHTML = 
                    'âŒ Ø³ÛŒØ³ØªÙ… Ø¯Ø±Ø¢Ù…Ø¯Ø²Ø§ÛŒÛŒ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª. Ù„Ø·ÙØ§ "node revenue.js" Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯.';
                return false;
            }
        }

        // Ø§Ù†Ø¬Ø§Ù… ÙØ±ÙˆØ´
        async function makeSale(productId) {
            const product = products[productId];
            
            if (!confirm(`Ø¢ÛŒØ§ Ù…Ø§ÛŒÙ„ Ø¨Ù‡ Ø®Ø±ÛŒØ¯ "${product.name}" Ø¨Ù‡ Ù…Ø¨Ù„Øº ${product.price.toLocaleString()} ØªÙˆÙ…Ø§Ù† Ù‡Ø³ØªÛŒØ¯ØŸ`)) {
                return;
            }

            try {
                const response = await fetch('http://localhost:3000/api/sell', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        productId: productId,
                        productName: product.name,
                        price: product.price
                    })
                });

                if (!response.ok) {
                    throw new Error(`Ø®Ø·Ø§ÛŒ Ø³Ø±ÙˆØ±: ${response.status}`);
                }

                const result = await response.json();
                
                if (result.success) {
                    alert(`âœ… Ø®Ø±ÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯!\n\nğŸ“¦ ${product.name}\nğŸ’° ${product.price.toLocaleString()} ØªÙˆÙ…Ø§Ù†\nğŸ¯ Ø¯Ø±Ø¢Ù…Ø¯ Ú©Ù„: ${result.total.toLocaleString()} ØªÙˆÙ…Ø§Ù†`);
                    // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢Ù…Ø§Ø±
                    checkConnection();
                } else {
                    alert('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª ÙØ±ÙˆØ´');
                }
                
            } catch (error) {
                alert(`âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±:\n${error.message}\n\nÙ„Ø·ÙØ§ Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯:\n1. node revenue.js Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡\n2. Ù¾ÙˆØ±Øª 3000 Ø¢Ø²Ø§Ø¯ Ø§Ø³Øª`);
                console.error('Error details:', error);
            }
        }

        // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø§ØªØµØ§Ù„
        checkConnection();
        
        // Ø¨Ø±Ø±Ø³ÛŒ Ø¯ÙˆØ±Ù‡â€ŒÛŒ Ø§ØªØµØ§Ù„ Ù‡Ø± 5 Ø«Ø§Ù†ÛŒÙ‡
        setInterval(checkConnection, 5000);

        console.log('ğŸš€ Ø³ÛŒØ³ØªÙ… ØªØªØ±Ø§Ø´Ø§Ù¾ ÙØ¹Ø§Ù„ Ø´Ø¯');
    </script>
</body>
</html>
